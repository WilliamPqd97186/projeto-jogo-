#define MAX_NOME 30
#define MAX_TIPO 15

typedef struct {
    char nome[MAX_NOME];
    char tipo[MAX_TIPO]; // alimento, arma, ferramenta
    int prioridade;      // 1=baixo, 3=alto
} Item;
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define MAX_ITENS 50

Item mochila[MAX_ITENS];
int qtdItens = 0;

void adicionarItem(Item novo) {
    if (qtdItens < MAX_ITENS) {
        mochila[qtdItens++] = novo;
        printf("‚úÖ Item '%s' adicionado!\n", novo.nome);
    } else {
        printf("‚ö†Ô∏è Mochila cheia!\n");
    }
}

void listarItens() {
    printf("\nüì¶ Itens na mochila:\n");
    for (int i = 0; i < qtdItens; i++)
        printf("[%d] %s (%s) - prioridade %d\n", i+1, mochila[i].nome, mochila[i].tipo, mochila[i].prioridade);
}

// Selection Sort por nome
void ordenarPorNome() {
    for (int i = 0; i < qtdItens - 1; i++) {
        int min = i;
        for (int j = i+1; j < qtdItens; j++) {
            if (strcmp(mochila[j].nome, mochila[min].nome) < 0)
                min = j;
        }
        Item temp = mochila[i];
        mochila[i] = mochila[min];
        mochila[min] = temp;
    }
}

// Busca bin√°ria (ap√≥s ordena√ß√£o)
int buscaBinaria(char *nome) {
    int ini = 0, fim = qtdItens - 1;
    while (ini <= fim) {
        int meio = (ini + fim) / 2;
        int cmp = strcmp(mochila[meio].nome, nome);
        if (cmp == 0) return meio;
        else if (cmp < 0) ini = meio + 1;
        else fim = meio - 1;
    }
    return -1;
}
typedef struct No {
    Item item;
    struct No *prox;
} No;

No* inicio = NULL;

void inserirLista(Item novo) {
    No* novoNo = malloc(sizeof(No));
    novoNo->item = novo;
    novoNo->prox = inicio;
    inicio = novoNo;
}

void listarLista() {
    No* aux = inicio;
    printf("\nüîó Itens na lista:\n");
    while (aux != NULL) {
        printf("- %s (%s) prioridade %d\n", aux->item.nome, aux->item.tipo, aux->item.prioridade);
        aux = aux->prox;
    }
}
void construirTorre() {
    printf("\nüèóÔ∏è Construindo torre de fuga...\n");
    ordenarPorNome();
    char *necessarios[] = {"madeira", "corda", "pedra"};
    int total = sizeof(necessarios)/sizeof(necessarios[0]);
    int prontos = 0;

    for (int i = 0; i < total; i++) {
        if (buscaBinaria(necessarios[i]) != -1) {
            printf("‚úîÔ∏è %s encontrada!\n", necessarios[i]);
            prontos++;
        } else {
            printf("‚ùå Falta %s!\n", necessarios[i]);
        }
    }

    if (prontos == total)
        printf("\nüöÄ Voc√™ construiu a torre e escapou da ilha!\n");
    else
        printf("\n‚õ∫ Ainda falta reunir todos os recursos...\n");
}
int main() {
    int opc;
    do {
        printf("\n=== üå¥ Sobreviv√™ncia na Ilha ===\n");
        printf("1. Adicionar item √† mochila\n");
        printf("2. Listar itens\n");
        printf("3. Ordenar itens por nome\n");
        printf("4. Buscar item (bin√°ria)\n");
        printf("5. Construir torre de fuga\n");
        printf("0. Sair\n> ");
        scanf("%d", &opc);
        getchar();

        if (opc == 1) {
            Item novo;
            printf("Nome: "); fgets(novo.nome, MAX_NOME, stdin); novo.nome[strcspn(novo.nome, "\n")] = 0;
            printf("Tipo (alimento/arma/ferramenta): "); fgets(novo.tipo, MAX_TIPO, stdin); novo.tipo[strcspn(novo.tipo, "\n")] = 0;
            printf("Prioridade (1-3): "); scanf("%d", &novo.prioridade); getchar();
            adicionarItem(novo);
        } else if (opc == 2) listarItens();
        else if (opc == 3) ordenarPorNome();
        else if (opc == 4) {
            char nome[MAX_NOME];
            printf("Buscar por nome: "); fgets(nome, MAX_NOME, stdin); nome[strcspn(nome, "\n")] = 0;
            int pos = buscaBinaria(nome);
            if (pos != -1) printf("üîç '%s' encontrado na posi√ß√£o %d!\n", nome, pos+1);
            else printf("‚ùå Item n√£o encontrado!\n");
        } else if (opc == 5) construirTorre();

    } while (opc != 0);
    return 0;
}
